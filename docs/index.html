<!doctype html>
<html>
    <head><title>My App</title></head>
    <body>
        <div id='app'></div>
        <script src='js/weddell-e5+ro+vd+hv+cv+ad.js'></script>
        <script>
            var App = Weddell.classes.App;

            var app = new App({
                el: '#app',
                component: {
                    markupFormat: '(locals:Object,h:Function)=>HTMLString',
                    markupTemplate: locals =>
                    `
                        <div>
                            ${locals.$component('myHeader')}

                            <h1>${locals.myAppTitle}</h1>

                            ${locals.$component('myFooter')}
                        </div>
                    `,
                    state: {
                        myAppTitle: 'A compendium of frog species'
                    },
                    components: {
                        myHeader: {
                            markupFormat: '(locals:Object,h:Function)=>HTMLString',
                            markupTemplate: locals =>
                            `
                                <header onclick="${locals.$bind("this.$act('disablethings', {mything:'moo'})")}">${locals.headerText}</header>
                            `,
                            state: {
                                headerText: 'Who doesn\'t love frogs?'
                            }
                        },
                        myBody: {
                            state: {

                            }
                        },
                        myFooter: {
                            markupFormat: '(locals:Object,h:Function)=>HTMLString',
                            markupTemplate: locals =>
                            `
                                ${!locals.disabled ? locals.coolContent : ''}
                                <footer>${locals.footerText}</footer>
                            `,
                            state: {
                                disabled: false,
                                coolContent: 'This is cool',
                                footerText: 'Copyright 2016, David Attenborough'
                            },
                            onInit: function() {
                                this.state.on('disablethings', function(evt){
                                    console.log('Disabling, sorry', evt.mything);
                                    this.disabled = true;
                                });
                                setTimeout(() => {
                                    this.state.footerText = 'Just kidding, copyright 2017, some other guy';
                                }, 3000);
                            }
                        }
                    }
                }
            });
            app.init();
        </script>
    </body>
</html>
