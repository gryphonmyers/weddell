var t=()=>{for(var t="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<5;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return t},e=(t,e)=>t.filter(t=>!e.includes(t));const n=Symbol("props"),r=Symbol("consts"),i=Symbol("bindEventHandlers"),s=Symbol("assignProps"),o=Symbol("renderStyles"),a=Symbol("inlineEventHandlers"),u=Symbol("bindTemplateFunction"),c=Symbol("renderers"),h=Symbol("renderResults"),l=Symbol("requestPatch"),f=Symbol("components"),d=Symbol("componentInstances"),v=Symbol("getComponentInstance"),p=Symbol("makeComponentInstance"),m=Symbol("prevRenderedComponents"),y=Symbol("mount"),b=Symbol("unmount"),g=Symbol("init"),w=Symbol("assignReservedStoreProperties");var E=({t:E,i:O,s:j})=>(class extends E{static get state(){return{}}static get o(){return[]}static get u(){return{}}static get h(){return{}}static get o(){return[]}async l(){}async v(){}async p(){return Promise.all(Object.values(this[c]).map(t=>t.m))}constructor({parent:e=null,state:o={},u:u={},id:l=t(),h:v={}}={}){super();const p=Object.assign({},e?e[f]:null,v,this.constructor.h);Object.defineProperties(this,{id:{value:l},content:{value:[],g:!0},[a]:{value:{}},[h]:{value:{}},[m]:{value:new Map,g:!0},[f]:{value:p},[d]:{value:Object.assign({},e?e[d]:null,Object.keys(this.constructor.h).reduce((t,e)=>Object.assign(t,{[e]:{}}),{}))},[c]:{value:new Proxy({},{get:(t,e)=>t[e],set:(t,e,n)=>(n.O("renderfinish",({result:t})=>this.j("renderfinish",{result:t})),t[e]=n,!0)})},[s]:{value:t=>{var r=!1;if(t){const[o,a,u]=Object.entries(t).reduce((t,[e,n])=>((this.constructor.o.some(t=>t===e||t.key===e)?t[0]:"on"!==e.slice(0,2)||e in O?t[2]:t[1])[e]=n,t),[this.constructor.o.reduce((e,n)=>n in t?e:Object.assign(e,{[n]:null}),{}),{},{}]);var s=()=>r=!0;this[n].O("change",s),Object.assign(this[n],o),this[n].C("change",s),this[i](a,e),this.state.S=Object.entries(u).filter(([t])=>"string"==typeof t).reduce((t,[e,n])=>Object.assign(t,{[e]:n}),{})}return r}}}),o=Object.assign({},o,this.constructor.state),u=Object.assign({},u,this.constructor.u);const y=Object.values(this.constructor.o).reduce((t,e)=>Object.assign(t,{[e]:null}),{});[o,u,y].forEach(t=>{for(var e in t)if("$"===e[0])throw new Error(`Component state keys may not start with the '$' character: "${e}"`)}),this[w]({u:u,state:o,R:y}),this.state=new j(o,{N:[this[n]=new j(y)],T:[this[r]=new j(u,{P:!0,V:!1})]}),this.state.O("change",({A:t})=>{for(var e in this[h]){const{k:n}=this[h][e];t in n&&this[c][e].I(this.state)}})}[w]({u:t,state:e}){Object.assign(t,{$:this.id}),Object.assign(e,{S:{}})}[l](t,e){this.j("requestpatch",{K:t,result:e})}async[o](){const t=[].concat(this.constructor.M).flat();return[...t.filter(t=>"string"==typeof t)].concat(this[EXEC_TEMPLATE_FUNCTION](o,t.filter(t=>"function"==typeof t)))}[u](t,e){return function(){const n=Date.now(),r={},i=({key:t})=>r[t]=1;this.state.O("get",i);const s=e(...arguments);return this.state.C("get",i),this[h][t]={k:r,q:s,timestamp:n},s}.bind(this)}async U(t){const n=Array.from(this[m].keys()),r=e(t,n),i=e(n,t);return await Promise.all(r.map(t=>t[y]()),i.map(t=>t[b]())),this[m]=new Map(t.map(t=>[t,null])),{W:r,H:i}}Y(t,e={}){var n=this.constructor.B.u;return`${e.preventDefault?"event.preventDefault();":""}${e.stopPropagation?"event.stopPropagation();":""}Promise.resolve((window['${n.G}'] && window['${n.G}'].app) || new Promise(function(resolve){ window.addEventListener('weddellinitbefore', function(evt) { resolve(evt.detail.app) }) })).then(function(app) { app.awaitComponentMount('${this.id}').then(function(component){ (function() {${t}}.bind(component))()})})`}[i](t,e){Object.entries(t).forEach(([t,n])=>{const r=t.slice(2),i=this[a];if(t in i){if(i[t].X===n)return;this.C(r,i[t].Z),delete i[t]}const s=new Function("component","event",n).bind(e,this);this[a][t]={X:n,Z:s},this.O(r,s)})}async[y](){}async[b](){}async[v]({tagName:t,rt:e}){const n=this[d][t],r=e||n.length;return n[r]||(n[r]=await this[p]({tagName:t}))}async it(t){const e=this.content.length!==t.length||this.content.some((e,n)=>e!==t[n]);return this.content=t,e}async[p]({tagName:t}){const e=this[f][t],n=new e({parent:this});return this.j("createcomponent",{ot:n,at:e}),await n[g](),n}async[g](){await this.v()}});const O=Symbol("eventProxies");var j=({EventTarget:t,CustomEvent:e})=>{class n extends e{constructor(t,e){super(t,e),this.ct=this.type,Object.assign(this,e.detail||null)}}class r extends t{constructor(){super(...arguments),this[O]=[]}once(t,e){return this.O(t,()=>this.C(t,e)),this.O(t,e)}dispatchEvent(t,e){var r=super.dispatchEvent(new n(t,{detail:e}));return this[O].forEach(n=>n.dispatchEvent(t,{detail:e})),r}ht(t){this[O].push(t)}}var i=r.prototype;return[["dispatchEvent",["trigger","emit"]],["removeEventListener",["off","removeListener"]],["addEventListener",["on","addListener"]]].forEach(([t,e])=>e.forEach(e=>i[e]=i[t])),r},C=({t:t})=>(class extends t{I(t){return this.lt.push(t),this.m||(this.m=this.ft()),this.m}ft(t=0){if(t>100)throw new Error("Too many rerenders");return new Promise(e=>setTimeout(async()=>{var n;n=await this.dt(this.lt.splice(0,this.lt.length)),n=this.vt?await this.vt(n):n,this.lt.length>0&&(n=await this.ft(t+1)),this.m=null,this.j("renderfinish",{result:n}),e(this.pt=n)},this.yt))}dt(){}constructor({vt:t,yt:e=0}={}){super(...arguments),Object.defineProperties(this,{vt:{value:t},yt:{value:e},m:{value:null,g:!0},lt:{value:[]},pt:{value:null,g:!0}})}}),S=Array.isArray,R=Object.keys,x=Object.prototype.hasOwnProperty,N=function t(e,n){if(e===n)return!0;if(e&&n&&"object"==typeof e&&"object"==typeof n){var r,i,s,o=S(e),a=S(n);if(o&&a){if((i=e.length)!=n.length)return!1;for(r=i;0!=r--;)if(!t(e[r],n[r]))return!1;return!0}if(o!=a)return!1;var u=e instanceof Date,c=n instanceof Date;if(u!=c)return!1;if(u&&c)return e.getTime()==n.getTime();var h=e instanceof RegExp,l=n instanceof RegExp;if(h!=l)return!1;if(h&&l)return e.toString()==n.toString();var f=R(e);if((i=f.length)!==R(n).length)return!1;for(r=i;0!=r--;)if(!x.call(n,f[r]))return!1;for(r=i;0!=r--;)if(!t(e[s=f[r]],n[s]))return!1;return!0}return e!=e&&n!=n};const T=Symbol("changedKeys"),P=Symbol("keyDeps"),V=Symbol("funcKeysByDepKey"),A=Symbol("executeFunctionProperty"),k=Symbol("funcKeyValues"),I=Symbol("staleFuncKeys");function F(t){return t&&"object"==typeof t?(Array.isArray(t)||t.constructor===Object||null===Object.getPrototypeOf(t))&&Object.values(t).every(F):null==t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t}var $=({t:t})=>(class extends t{constructor(t,{V:e=!0,bt:n=!0,gt:r=!0,P:i=!1,T:s=[],N:o=[]}={}){return super(),[...o,...s].forEach(t=>{Object.assign(this,Object.keys(t).reduce((t,e)=>Object.assign(t,{[e]:null}),{})),t.ht(this)}),Object.assign(this,t),[V,I,k,P].forEach(t=>this[t]={}),this[T]=[],Object.defineProperty(this,"wt",{value:new Proxy(this,{get:(t,n)=>{if(!t.propertyIsEnumerable(n))return t[n];var r=[...o,t,...s].reduce((t,r)=>null!=t?t:e?r[A](r[n],n):r[n],null);return this.j("get",{key:n,value:r}),r},set:(t,s,o)=>{if(!t.propertyIsEnumerable(s))return t[s]=o,!0;if(i)throw new Error(`Can't set key ${s}, as store is immutable.`);if(r&&!F(o))throw new Error(`Value being set to ${s} is not serializable`);const a=t[s];if(n&&!N(o,a)){if(this[T].push(s),e&&this[V][s])for(var u in this[V][s])this[I][u]=1;this.j("change",{target:this,A:s,newValue:o,oldValue:a})}return t[s]=o,!0}})}),Object.seal(this),this.wt}[A](t,e){if("function"!=typeof t)return t;if(!(e in this[k])||e in this[I]){const i={};for(var n in this[P][e]||{})n in this[V]&&delete this[V][n][e];var r=({key:t})=>{i[t]=1,t in this[V]||(this[V][t]={}),this[V][t][e]=1};return this.O("get",r),t=t.call(this.wt),this.C("get",r),this[P][e]=i,delete this[I][e],this[k][e]=t}return this[k][e]}});const weddell={},_=Symbol("installedPlugins");Object.defineProperties(weddell,{Ot:{value:{}},[_]:{value:new Map}}),Object.assign(weddell,{jt:E,Ct:j,St:C,Rt:C,xt:$,EventTarget:null,CustomEvent:null,i:null,Nt(t,e){Object.defineProperty(this,t,{get:function(){return this.Ot[t]||(this.Ot[t]=e.call(this))}})},Tt:function(){var t=Array.from(arguments).flat();return t.forEach(t=>{if(!this[_].has(t)){for(var e in t(this),this.Ot)delete this.Ot[e];this[_].set(t)}}),this}});var K=[["EventEmitter",function(){const{EventTarget:t,CustomEvent:e}=this;return this.Ct({EventTarget:t,CustomEvent:e})}],["Store",function(){const{t:t}=this;return this.xt({t:t})}],["Component",function(){const{t:t,s:e,i:n,Pt:r}=this;return this.jt({t:t,s:e,i:n,Pt:r})}],["Renderer",function(){const{t:t}=this;return this.St({t:t})}],["App",function(){const{t:t,Pt:e}=this;return this.Rt({t:t,Pt:e})}]];function D(weddell){Object.assign(weddell,{EventTarget:window.EventTarget,CustomEvent:window.CustomEvent,i:document})}K.forEach(([t,e])=>{weddell.Nt(t,e)});var M=Array.isArray,L=Object.prototype.toString,q=M||z;function z(t){return"[object Array]"===L.call(t)}var U="2",W=H;function H(t){return t&&"VirtualNode"===t.type&&t.version===U}var Y=B;function B(t){return t&&"Widget"===t.type}var G=J;function J(t){return t&&"Thunk"===t.type}var X=Z;function Z(t){return t&&("function"==typeof t.Vt&&!t.hasOwnProperty("hook")||"function"==typeof t.At&&!t.hasOwnProperty("unhook"))}var Q=nt,tt={},et=[];function nt(t,e,n,r,i){this.tagName=t,this.properties=e||tt,this.children=n||et,this.key=null!=r?String(r):void 0,this.kt="string"==typeof i?i:null;var s,o=n&&n.length||0,a=0,u=!1,c=!1,h=!1;for(var l in e)if(e.hasOwnProperty(l)){var f=e[l];X(f)&&f.At&&(s||(s={}),s[l]=f)}for(var d=0;d<o;d++){var v=n[d];W(v)?(a+=v.count||0,!u&&v.It&&(u=!0),!c&&v.Ft&&(c=!0),h||!v.$t&&!v._t||(h=!0)):!u&&Y(v)?"function"==typeof v.Kt&&(u=!0):!c&&G(v)&&(c=!0)}this.count=o+a,this.It=u,this.Ft=c,this.$t=s,this._t=h}nt.prototype.version=U,nt.prototype.type="VirtualNode";var rt=it;function it(t){this.text=String(t)}it.prototype.version=U,it.prototype.type="VirtualText";var st=ot;function ot(t){return t&&"VirtualText"===t.type&&t.version===U}var at=function(t){var e=String.prototype.split,n=/()??/.exec("")[1]===t;return function(r,i,s){if("[object RegExp]"!==Object.prototype.toString.call(i))return e.call(r,i,s);var o,a,u,c,h=[],l=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.Dt?"x":"")+(i.sticky?"y":""),f=0;i=new RegExp(i.source,l+"g");for(r+="",n||(o=new RegExp("^"+i.source+"$(?!\\s)",l)),s=s===t?-1>>>0:s>>>0;(a=i.exec(r))&&!((u=a.index+a[0].length)>f&&(h.push(r.slice(f,a.index)),!n&&a.length>1&&a[0].replace(o,(function(){for(var e=1;e<arguments.length-2;e++)arguments[e]===t&&(a[e]=t)})),a.length>1&&a.index<r.length&&Array.prototype.push.apply(h,a.slice(1)),c=a[0].length,f=u,h.length>=s));)i.lastIndex===a.index&&i.lastIndex++;return f===r.length?!c&&i.test("")||h.push(""):h.push(r.slice(f)),h.length>s?h.slice(0,s):h}}(),ut=/([\.#]?[a-zA-Z0-9\u007F-\uFFFF_:-]+)/,ct=/^\.|#/,ht=lt;function lt(t,e){if(!t)return"DIV";var n,r,i,s,o=!e.hasOwnProperty("id"),a=at(t,ut),u=null;for(ct.test(a[1])&&(u="DIV"),s=0;s<a.length;s++)(r=a[s])&&(i=r.charAt(0),u?"."===i?(n=n||[]).push(r.substring(1,r.length)):"#"===i&&o&&(e.id=r.substring(1,r.length)):u=r);return n&&(e.className&&n.push(e.className),e.className=n.join(" ")),e.kt?u:u.toUpperCase()}var ft=dt;function dt(t){if(!(this instanceof dt))return new dt(t);this.value=t}dt.prototype.Vt=function(t,e){t[e]!==this.value&&(t[e]=this.value)};var vt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},pt="undefined"!=typeof window?window:void 0!==vt?vt:{},mt=yt;function yt(t,e){return t in pt?pt[t]:(pt[t]=e,e)}var bt=gt;function gt(t,e,n){var r="__INDIVIDUAL_ONE_VERSION_"+t,i=mt(r+"_ENFORCE_SINGLETON",e);if(i!==e)throw new Error("Can only have one copy of "+t+".\nYou already have version "+i+" installed.\nThis means you cannot install version "+e);return mt(r,n)}var wt="7";bt("ev-store",wt);var Et="__EV_STORE_KEY@"+wt,Ot=jt;function jt(t){var e=t[Et];return e||(e=t[Et]={}),e}var Ct=St;function St(t){if(!(this instanceof St))return new St(t);this.value=t}St.prototype.Vt=function(t,e){Ot(t)[e.substr(3)]=this.value},St.prototype.At=function(t,e){Ot(t)[e.substr(3)]=void 0};var Rt=xt;function xt(t,e,n){var r,i,s,o,a=[];return!n&&Vt(e)&&(n=e,i={}),r=ht(t,i=i||e||{}),i.hasOwnProperty("key")&&(s=i.key,i.key=void 0),i.hasOwnProperty("namespace")&&(o=i.kt,i.kt=void 0),"INPUT"!==r||o||!i.hasOwnProperty("value")||void 0===i.value||X(i.value)||(i.value=ft(i.value)),Tt(i),null!=n&&Nt(n,a,r,i),new Q(r,i,a,s,o)}function Nt(t,e,n,r){if("string"==typeof t)e.push(new rt(t));else if("number"==typeof t)e.push(new rt(String(t)));else if(Pt(t))e.push(t);else{if(!q(t)){if(null==t)return;throw At({Mt:t,Lt:{tagName:n,properties:r}})}for(var i=0;i<t.length;i++)Nt(t[i],e,n,r)}}function Tt(t){for(var e in t)if(t.hasOwnProperty(e)){var n=t[e];if(X(n))continue;"ev-"===e.substr(0,3)&&(t[e]=Ct(n))}}function Pt(t){return W(t)||st(t)||Y(t)||G(t)}function Vt(t){return"string"==typeof t||q(t)||Pt(t)}function At(t){var e=new Error;return e.type="virtual-hyperscript.unexpected.virtual-element",e.message="Unexpected virtual child passed to h().\nExpected a VNode / Vthunk / VWidget / string but:\ngot:\n"+kt(t.Mt)+".\nThe parent vnode is:\n"+kt(t.Lt),e.Mt=t.Mt,e.Lt=t.Lt,e}function kt(t){try{return JSON.stringify(t,null,"    ")}catch(e){return String(t)}}var It=Rt;class Ft{constructor({tagName:t,properties:e={},children:n=[],ot:r=null}){this.type="Widget",this.properties=e,this.children=n,this.qt=e.key||e.attributes&&(e.attributes["zt"]||e.attributes.id),this.tagName=t,this.timestamp=Date.now(),this.ot=r}refresh(){const{tagName:t,properties:e,children:n,ot:r}=this;return new this.constructor({tagName:t,properties:e,children:n,ot:r})}Ut(t){return this.ot=t}update(){}Kt(){}init(){}dt(){return this.ot[h].Wt.q}}const $t=Symbol("widget");var _t=({Pt:t})=>(class extends t{constructor({Ht:t,Yt:e,Bt:n,Gt:r}={}){super(...arguments),this.Yt=e,this.Bt=n,this.Gt=r,this.Ht=t}Jt(t,e,n={},r=[]){if(Array.isArray(n)&&(r=n,n={}),e=e.toLowerCase(),this.Yt(e)){const i=new Ft({tagName:e,properties:n,children:r});return t.push(i),i}return"content"===e?this.Gt():It(e,n,new Proxy(r.flat(),{get:(t,e)=>t[e]instanceof Ft&&t[e].ot?t[e].ot[$t]:t[e]}))}async dt([t]){const e=[],n=this.Ht(t,this.Jt.bind(this,e));return{Xt:await Promise.all(e.map(async t=>{const e=await this.Bt({rt:t.qt,tagName:t.tagName});e[$t]=t,t.Ut(e);const n=await e[s](t.properties.attributes),r=e.it(t.children);return(!e[h].Wt||n||r)&&await e[c].Wt.I(e.state),e})),Zt:n}}});function Kt(weddell){const{jt:t}=weddell;Object.assign(weddell,{jt:function(){return class extends(t(...arguments)){constructor(){super(...arguments);var t=null;Object.defineProperties(this,{[$t]:{get:()=>t&&t.timestamp<this[h].Wt.timestamp?t=t.refresh():t,set:e=>t=e}}),this[c].Wt=new weddell.Qt({Ht:this[u]("vdom",this.constructor.Zt),Bt:this[v].bind(this),Yt:t=>this[f][t],vt:async({Xt:t,Zt:e})=>(await this.U(t),await this.l(),e),Gt:()=>this.content})}}},te:_t}),weddell.Nt("VdomRenderer",(function(){const{Pt:t}=this;return this.te({Pt:t})}))}weddell.Tt(D,Kt);export default weddell;